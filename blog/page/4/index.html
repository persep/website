<!DOCTYPE html> <html> <head> <title>Alpine Lab, blog technique</title> <meta charset=UTF-8> <meta content="On parle de développement web, d'entreprenariat, de Ruby, de Rails, de Haml, de CSS/Sass, de CoffeeScript et d'Ember.js, ..." name=description> <meta content='width=device-width, initial-scale=1.0, user-scalable=no' name=viewport> <meta content='Alpine Lab, blog technique' property='og:title'> <meta content="On parle de développement web, d'entreprenariat, de Ruby, de Rails, de Haml, de CSS/Sass, de CoffeeScript et d'Ember.js, ..." property='og:description'> <meta content=fr_FR property='og:locale'> <meta content='Alpine Lab' property='og:site_name'> <meta content='http://www.alpine-lab.com/blog/page/4/' property='og:url'> <meta content='http://www.alpine-lab.com../../../images/logo-alpinelab-500.png' property='og:image'> <meta content=website property='og:type'> <link href='images/favicon.png' rel=icon> <link href='//fonts.googleapis.com/css?family=Lato:300,400,700%7CMontserrat:400,700' rel=stylesheet> <link href="../../../stylesheets/blog-fb2780ef.css" rel=stylesheet /> <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.min.css" rel=stylesheet /> </head> <body class='blog blog_page blog_page_4 blog_page_4_index'> <meta content='Alpine Lab, blog technique' itemprop=name> <meta content="On parle de développement web, d'entreprenariat, de Ruby/Rails, de Haml/Slim, de Sass, de CoffeeScript et d'Ember.js" itemprop=description> <meta content='http://www.alpine-lab.com/blog' itemprop=url> <meta content=fr itemprop=inLanguage> <meta content='http://www.alpine-lab.com../../../images/logo-alpinelab-500.png' itemprop=image> <div id=wrapper> <header> <a href="/blog"><div class=logo></div> <h1 class=sitename><span class=alpine>Alpine</span><span class=lab>Lab</span> <span class=blog>blog technique</span> </h1> </a> <div class=social-networks> <a target=_blank href="https://github.com/alpinelab"><i class='fa fa-github'></i> </a> <a target=_blank href="https://twitter.com/alpinelab"><i class='fa fa-twitter'></i> </a> </div> </header> <div id=main> <section class=posts-listing> <article itemscope itemtype='http://schema.org/BlogPosting'> <meta content='&lt;p&gt;Pour ce blog j&#x0027;utilise &lt;a href="//middlemanapp.com"&gt;Middleman&lt;/a&gt;, j&#x0027;ai donc un repository pour les sources. Mais dès qu&#x0027;il s&#x0027;agit de déployer (i.e. compiler puis pusher les fichiers compilés sur un autre repository, que &lt;a href="http://pages.github.com"&gt;github:pages&lt;/a&gt; reconnait comme devant les mettre en ligne), voil...&lt;/p&gt;' itemprop=description> <meta content='http://www.alpine-lab.com/blog/un-alias-git-c-est-toujours-pratique/' itemprop=url> <meta content=fr itemprop=inLanguage> <h2 itemprop='name headline'><a href="/blog/un-alias-git-c-est-toujours-pratique/">Un alias git, c'est toujours pratique</a></h2> <div class=post-body itemprop=articleBody> <p>Pour ce blog j&#39;utilise <a href="//middlemanapp.com">Middleman</a>, j&#39;ai donc un repository pour les sources. Mais dès qu&#39;il s&#39;agit de déployer (i.e. compiler puis pusher les fichiers compilés sur un autre repository, que <a href="//pages.github.com">github:pages</a> reconnait comme devant les mettre en ligne), voilà la séquence de commandes que je dois executer :</p> <pre class="highlight shell"><code><span class="gp">$ </span>git push&#x000A;<span class="gp">$ </span>middleman build --clean&#x000A;<span class="gp">$ </span>middleman deploy --clean&#x000A;</code></pre> <p>Épuisant.</p> <p>J&#39;ai donc besoin d&#39;un moyen d&#39;éxécuter toutes ces commandes d&#39;un coup. Comme un alias ou un scriptshell seraient trop faciles, j&#39;ai regardé du côté des <em>alias git</em>.</p> <p>En gros, je veux pouvoir tout simplement entrer :</p> <pre class="highlight shell"><code><span class="gp">$ </span>git dpush <span class="c"># 'dpush' commme 'deploy &amp; push'</span>&#x000A;</code></pre> <p>Il suffit donc de déclarer un alias git comme ça :</p> <pre class="highlight shell"><code><span class="gp">$ </span>git config alias.dpush <span class="s1">'!git push origin master &amp;&amp; middleman build --clean &amp;&amp; middleman deploy --clean'</span>&#x000A;</code></pre> <p>Cette commande va ajouter les lignes suivantes au fichier <code>.git/config</code> :</p> <pre class="highlight plaintext"><code>[alias]&#x000A;  dpush = !git push origin master &amp;&amp; middleman build --clean &amp;&amp; middleman deploy --clean&#x000A;</code></pre> <p>Voilà, plus qu&#39;à executer <code>git dpush</code> pour pusher son code, compiler, puis déployer un nouvel article.</p> <h4 id=notes>Notes</h4> <ol> <li>Le point d&#39;exclamation (!) en première position de l&#39;alias sert à indiquer que c&#39;est une commande à part entière. Sans ce point d&#39;exclamation, les alias portent par défaut sur d&#39;autres commandes git. Genre, pour pouvoir écrire <code>git st</code> au lieu de <code>git status</code>, comme <a href="//pioupioum.fr/developpement/git-alias-productivite.html">piouPiouM</a> : <code>&#x000A;[alias]&#x000A;st = status</code></li> <li>Comme on le déclare ici, l&#39;alias est local : il ne s&#39;applique qu&#39;au repository courant (d&#39;ailleurs il est stocké dans <code>.git/config</code> qui est la config du repository courant uniquement). Pour créer un alias qui fonctionne partout, il faut utiliser le switch <code>--global</code> : l&#39;alias sera alors déclaré non pas dans <code>.git/config</code> mais dans <code>~/.gitconfig</code> et sera donc accessible dans tous vos repository git.</li> </ol> <h4 id=sources>Sources</h4> <p>Tout est parti d&rsquo;<a href="//stackoverflow.com/a/3466589">une réponse sur StackOverflow</a></p> </div> </article> <article itemscope itemtype='http://schema.org/BlogPosting'> <meta content='&lt;p&gt;Comment utiliser son beau nom de domaine qu&amp;#39;on vient de réserver pour son site hébergé sur &lt;a href="//pages.github.com"&gt;GitHub Pages&lt;/a&gt; ? En fait c&amp;#39;est très simple et tout est expliqué dans la &lt;a href="https://help.github.com/articles/setting-up-a-custom-domain-with-pages"&gt;documentation officielle&lt;/a&gt; (RTFM, comme on dit).' itemprop=description> <meta content='http://www.alpine-lab.com/blog/un-nom-de-domaine-personnalise-sur-github-pages/' itemprop=url> <meta content=fr itemprop=inLanguage> <h2 itemprop='name headline'><a href="/blog/un-nom-de-domaine-personnalise-sur-github-pages/">Un nom de domaine personnalisé sur GitHub Pages</a></h2> <div class=post-body itemprop=articleBody> <p>Comment utiliser son beau nom de domaine qu&#39;on vient de réserver pour son site hébergé sur <a href="//pages.github.com">GitHub Pages</a> ? En fait c&#39;est très simple et tout est expliqué dans la <a href="https://help.github.com/articles/setting-up-a-custom-domain-with-pages">documentation officielle</a> (RTFM, comme on dit).</p> <h3 id=configuration-de-github-pages>Configuration de GitHub Pages</h3> <p>Il faut tout d&#39;abord créer un fichier <code>CNAME</code> à la racine de son site qui contient le nom de domaine qu&#39;on veut utiliser (moi, pour ce blog, c&#39;est <a href="//www.alpine-lab.com">www.alpine-lab.com</a>). Comme j&#39;utilise Middleman, ça donne donc ça (la racine du site est dans le sous-répertoire <code>source</code>) :</p> <pre class="highlight shell"><code><span class="gp">$ </span><span class="nb">echo</span> <span class="s2">"www.alpine-lab.com"</span> &gt; <span class="nb">source</span>/CNAME&#x000A;</code></pre> <p>Voilà, c&#39;est tout.</p> <p>Une fois cette modification déployée, GitHub Pages saura que quand un navigateur lui demande <code>www.alpine-lab.com</code>, il devra répondre avec notre site.</p> <p>Comme il est malin, il va créer automatiquement certaines redirections. Là, dans notre exemple, si on pointe son navigateur sur <code>alpinelab.github.com</code> (l&#39;adresse d&#39;origine), il nous redirigera automatiquement sur <code>www.alpine-lab.com</code>. Même chose avec <code>alpine-lab.com</code> (sans les <code>www</code>). Pratique, non ?</p> <h3 id=configuration-dns>Configuration DNS</h3> <p>Tout ce qu&#39;il reste à faire, c&#39;est quand même configurer votre serveur DNS pour que <code>www.alpine-lab.com</code> et <code>alpine-lab.com</code> soient redirigés vers l&#39;adresse IP de GitHub Pages (entrée A dans votre config DNS) <code>204.232.175.78</code> ou vers le nom de domaine (entrée CNAME) <code>alpinelab.github.com</code>.</p> <p>Voilà à quoi ressemble la conf DNS, chez moi : <img title="Configuration DNS qui pointe vers GitHub Pages" alt="Configuration DNS qui pointe vers GitHub Pages" width=961 height=152 src="../../images/blog/nom-de-domaine-personnalise-sur-github-pages-00-screen-eurodns-ee2a5fce.png"/></p> <p>Voilà. C&#39;est tout bon.</p> <h4 id="bonus-:-patience-!">Bonus : patience !</h4> <p>GitHub Pages peut mettre jusqu&#39;à 10 minutes pour réagir et se rendre compte qu&#39;on lui a pushé un fichier CNAME. Inutile de péter un cable parce que ça ne marche pas immédiatement, il faut parfois simplement attendre. Je dis ça parce que ça m&#39;est arrivé.</p> <h4 id=sources>Sources</h4> <ul> <li>La <a href="https://help.github.com/articles/setting-up-a-custom-domain-with-pages">documentation officielle</a> de GitHub Pages</li> </ul> </div> </article> <article itemscope itemtype='http://schema.org/BlogPosting'> <meta content='&lt;p&gt;Quand vous développez (en Ruby, entre autres), vous écrivez des tests, n&amp;#39;est-ce pas ? Carrément en &lt;a href="//fr.wikipedia.org/wiki/Test_Driven_Development"&gt;TDD&lt;/a&gt; ou au moins pour assurer la &lt;a href="http://fr.wikipedia.org/wiki/Non-r%C3%A9gression"&gt;non-régression&lt;/a&gt;, j&amp;#39;espère. Le problème est : comment être sûr que tout votre code est bien testé ? Que vous n&amp;#39;avez pas un peu zappé d&amp;#39;écrire de tests pour telle méthode ou telle classe ?' itemprop=description> <meta content='http://www.alpine-lab.com/blog/utiliser-coveralls-pour-verifier-la-couverture-de-vos-tests/' itemprop=url> <meta content=fr itemprop=inLanguage> <h2 itemprop='name headline'><a href="/blog/utiliser-coveralls-pour-verifier-la-couverture-de-vos-tests/">Utiliser Coveralls.io pour vérifier la couverture de vos tests</a></h2> <div class=post-body itemprop=articleBody> <p>Quand vous développez (en Ruby, entre autres), vous écrivez des tests, n&#39;est-ce pas ? Carrément en <a href="//fr.wikipedia.org/wiki/Test_Driven_Development">TDD</a> ou au moins pour assurer la <a href="//fr.wikipedia.org/wiki/Non-r%C3%A9gression">non-régression</a>, j&#39;espère. Le problème est : comment être sûr que tout votre code est bien testé ? Que vous n&#39;avez pas un peu zappé d&#39;écrire de tests pour telle méthode ou telle classe ?</p> <p>La réponse s&#39;appelle la <a href="//fr.wikipedia.org/wiki/Couverture_de_code">couverture de code</a> (&ldquo;code coverage&rdquo;, en anglais). Ça consiste à calculer le pourcentage de votre code qui est couvert par des tests. La chance, c&#39;est qu&#39;en Ruby, si votre code est hébergé sur <a href="//github.com">GitHub</a>, il existe une solution en SaaS qui fait ça toute seule : <a href="https://coveralls.io">Coveralls</a> !</p> <h3 id=inscription>Inscription</h3> <p>Il faut en premier lieu s&#39;inscrire sur <a href="https://coveralls.io">Coveralls.io</a>, mais grâce à l&#39;authentification GitHub, c&#39;est fait en 2 clics.</p> <p>Coveralls vous demandera ensuite sur quels repositories vous voulez l&#39;activer avec des petits boutons on/off très intuitifs (comme souvent, c&#39;est gratuit pour les projets open-source, payant pour les projets privés) :</p> <p><img title="Liste de vos projets qui utilisent Coveralls" alt="Liste de vos projets qui utilisent Coveralls" width=760 height=202 src="../../images/blog/coveralls-repositories-2e1cd816.png"/></p> <h3 id=installation>Installation</h3> <p>Comme d&#39;habitude, c&#39;est super simple, il y a une gem à ajouter à votre fichier <code>Gemfile</code> :</p> <pre class="highlight ruby"><code><span class="n">gem</span> <span class="s1">'coveralls'</span><span class="p">,</span> <span class="ss">require: </span><span class="kp">false</span>&#x000A;</code></pre> <p>Puis, il suffit de faire un <code>bundle install</code> pour l&#39;installer.</p> <p>Enfin, il faut dire à notre suite de tests d&#39;utiliser la gem, en ajoutant les lignes suivantes au fichier de config de votre suite de tests (moi j&#39;utilise <a href="//rspec.info">RSpec</a> donc c&#39;est <code>spec/spec_helper.rb</code>, mais je vous laisse adapter à votre suite de test : Coveralls est compatible entre-autres avec <a href="//rspec.info">RSpec</a>, <a href="//cukes.info">Cucumber</a>, <a href="//ruby-doc.org/stdlib-1.9.3/libdoc/test/unit/rdoc/Test/Unit.html">Test::Unit</a>, &hellip;) :</p> <pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'coveralls'</span>&#x000A;<span class="no">Coveralls</span><span class="p">.</span><span class="nf">wear!</span>&#x000A;</code></pre> <p>Ou, pour une application Rails :</p> <pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'coveralls'</span>&#x000A;<span class="no">Coveralls</span><span class="p">.</span><span class="nf">wear!</span><span class="p">(</span><span class="s1">'rails'</span><span class="p">)</span>&#x000A;</code></pre> <h3 id=configuration>Configuration</h3> <p>Si vous utilisez <a href="https://travis-ci.org">Travis</a>, c&#39;est très simple : il n&#39;y a rien de plus à faire ! Dès votre prochain push, Travis devrait donc tester votre build, et envoyer le rapport à Coveralls, qui calculera en détail la couverture de votre code.</p> <p>Si vous utilisez <a href="https://semaphoreapp.com">Semaphore</a> ou <a href="https://circleci.com">CircleCI</a>, ça marche aussi, mais je n&#39;ai pas testé : je vous laisse vous reporter à la <a href="https://coveralls.io/docs/ruby">documentation</a>.</p> <p>Si vous n&#39;utilisez pas de service d&#39;intégration continue, je vous conseille de vous y mettre rapidement, c&#39;est de la tuerie. Moi j&#39;adore <a href="https://travis-ci.org">Travis</a>, et en plus, il est gratuit pour les projets open-source. Sinon, pour Coveralls, vous pouvez le configurer (en ajoutant une variable <code>repo_token</code> à un fichier <code>.coveralls.yml</code>) pour pouvoir faire des analyse de couverture à la main, avec un simple <code>bundle exec coveralls push</code>.</p> <h3 id="résultat">Résultat</h3> <p>Sur le site de Coveralls, vous pouvez donc voir un résumé de votre projet, build par build :</p> <p><img title="Un projet sur Coveralls" alt="Un projet sur Coveralls" width=1016 height=332 src="../../images/blog/coveralls-project-66db2f67.png"/></p> <p>Pour chaque build, un résumé fichier par fichier :</p> <p><img title="Un build sur Coveralls" alt="Un build sur Coveralls" width=987 height=952 src="../../images/blog/coveralls-build-54086489.png"/></p> <p>Et enfin, le truc le plus utile et productif : pour chaque fichier, le détail de couverture ligne par ligne :</p> <p><img title="Un fichier sur Coveralls" alt="Un fichier sur Coveralls" width=1009 height=550 src="../../images/blog/coveralls-file-eac7b3ac.png"/></p> <p>Là, par exemple, on voit que je n&#39;ai pas écris de test pour la méthode <code>download_best_subtitle</code>, ce que je peux donc m&#39;empresser d&#39;aller faire.</p> <h3 id="bonus-:-le-badge-github">Bonus : le badge GitHub</h3> <p>On peut même récupérer le code pour insérer un badge dans notre README, pour avoir la classe américaine sur GitHub :</p> <p><img title="Badge Coveralls sur GitHub" alt="Badge Coveralls sur GitHub" width=954 height=202 src="../../images/blog/coveralls-badge-b9e31151.png"/></p> <h4 id=sources>Sources</h4> <ul> <li>Le site de <a href="https://coveralls.io">Coveralls</a></li> <li>La <a href="https://coveralls.io/docs/ruby">doc Coveralls</a> pour Ruby</li> </ul> </div> </article> <div class=pagination-wrapper> <a class=previous-page href="/blog/page/3/">&larr; Articles plus récents</a> <a class=next-page href="/blog/page/5/">Articles plus anciens &rarr;</a> <div class=pagination> Page 4 sur 6 </div> </div> </section> </div> </div> <div id=corporate-btn> <a href="/">Alpine Lab <span class=caret></span> </a> </div> <footer> <p> Le blog d'<a rel=publisher href="https://plus.google.com/+AlpineLab">Alpine Lab</a> est publié sous license <a href="//creativecommons.org/licenses/by/3.0/fr/">Creative Commons Attribution 3.0 (cc-by-3.0)</a>. Le code est sous licence <a href="//opensource.org/licenses/MIT">MIT</a>. </p> </footer> </body> </html>